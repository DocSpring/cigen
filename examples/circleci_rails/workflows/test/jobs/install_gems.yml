image: cimg/ruby:3.3.5
architectures: ["amd64", "arm64"]
resource_class: large

cache:
  gems: "vendor/bundle"

steps:
  - run:
      name: Install gems
      command: |
        # Configure bundle for deployment
        bundle config set --local deployment 'true'
        bundle config set --local without 'development'
        bundle install --jobs=4 --retry=3
        bundle binstubs --all
        bundle clean --force
        bundle check
